"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2968],{976:(k,f,r)=>{r.r(f),r.d(f,{TasksPageModule:()=>j});var d=r(1368),h=r(4716),s=r(9548),c=r(8424),g=r(5444),m=r(1528),o=r(4708),a=r(1800),t=r(4496),C=r(3492),v=r(628),T=r(9448);function y(i,p){if(1&i){const u=t.KQA();t.I0R(0,"ion-card",14)(1,"div",15)(2,"ion-card-content",16)(3,"span",17),t.OEk(4),t.C$Y(),t.I0R(5,"ion-card-title")(6,"span",18),t.OEk(7),t.C$Y()()(),t.I0R(8,"div",19),t.wR5(9,"ion-progress-bar",20),t.I0R(10,"ion-button",21),t.qCj("click",function(){const l=t.usT(u).$implicit,P=t.GaO();return t.CGJ(P.openProjectDetailsHomeModal(l))}),t.wR5(11,"ion-icon",22),t.C$Y()()()()}if(2&i){const u=p.$implicit,e=t.GaO();t.yG2(4),t.oRS(" ",e.daysUntilDeadline(u.deadline)," days left "),t.yG2(3),t.oRS("",u.projectName," "),t.yG2(2),t.E7m("value",e.tasksMap[u.id].completionRate/100)}}const M=[{path:"",component:(()=>{var i;class p{constructor(e,n,l,P,b,O){this.modalController=e,this.toastController=n,this.router=l,this.projectService=P,this.userService=b,this.taskService=O,this.projects=[],this.tasksMap={},this.todayTasksMap={},this.tasks=[],this.sliderConfig={slidesPerView:1,spaceBetween:20,navigation:!0,pagination:{clickable:!0}}}playCheckboxAnimation(e,n){console.log(e);const l="completed"===n.status?"not completed":"completed";this.taskService.updateTaskStatus(n.id,l).subscribe({next:()=>{n.status=l,(0,o.U6)("").addElement(e.srcElement).easing("cubic-bezier(0, 0.55, 0.45, 1)").duration(500).fromTo("transform","rotate(0)","rotate(360deg)").play()},error:P=>console.error("Failed to update task status:",P)})}ngOnInit(){this.loadProjects(),this.archiveAndDeleteCompletedTasks(),this.username=localStorage.getItem("username")}archiveAndDeleteCompletedTasks(){this.taskService.archiveAndDeleteCompletedTasks().subscribe({next:e=>{e.success?this.loadProjects():console.error("API succeeded but indicated failure:",e.message)},error:e=>{console.error("Failed to archive and delete tasks:",e.error)}})}loadProjects(){this.projectService.getAssignedProjects().subscribe({next:e=>{this.projects=e,e.forEach(n=>{this.loadTasksForProject(n.id),this.loadTasksDueToday(n.id)})},error:e=>console.error("Failed to load projects",e)})}calculateCompletionRate(e){const n=e.filter(l=>"completed"===l.status).length;return e.length>0?n/e.length*100:0}loadTasksDueToday(e){this.taskService.getTodayTasksByProject(e).subscribe({next:n=>{this.todayTasksMap[e]=n},error:n=>{console.error("Failed to load today's tasks:",n),this.todayTasksMap[e]=[]}})}loadTasksForProject(e){this.taskService.getAllTasksByProject(e).subscribe({next:n=>{const l=n.filter(b=>"completed"===b.status).length;this.tasksMap[e]={tasks:n,completionRate:n.length>0?l/n.length*100:0}},error:n=>{console.error(`Failed to load tasks for project ${e}`,n),this.tasksMap[e]={tasks:[],completionRate:0}}})}openProjectDetailsHomeModal(e){var n=this;return(0,m.c)(function*(){try{yield(yield n.modalController.create({component:a.k,componentProps:{project:e}})).present()}catch(l){console.error("Error opening modal",l),n.showToast("Failed to open project details. Please try again later.")}})()}showToast(e){var n=this;return(0,m.c)(function*(){(yield n.toastController.create({message:e,duration:3e3,position:"bottom"})).present()})()}goToSettings(){this.router.navigateByUrl("/settings-admin")}goToTasks(){this.router.navigateByUrl("/tasks-admin")}goToHome(){this.router.navigateByUrl("/admin-homepage")}handleRefresh(e){setTimeout(()=>{this.loadProjects(),e.detail.complete()},1e3)}daysUntilDeadline(e){const n=new Date(e),l=new Date,P=n.getTime()-l.getTime();return Math.ceil(P/864e5)}goToTasksPage(){this.router.navigateByUrl("/tasks-admin")}}return(i=p).\u0275fac=function(e){return new(e||i)(t.GI1(s.qS),t.GI1(s.Gq),t.GI1(c.E5),t.GI1(C.U),t.GI1(v.o),t.GI1(T.K))},i.\u0275cmp=t.In1({type:i,selectors:[["app-tasks"]],decls:27,vars:3,consts:[[3,"translucent"],["size","large",2,"font-size","24px","margin-left","20px"],[3,"fullscreen"],["collapse","condense"],["size","large"],[1,"card-container"],["class","projects",4,"ngFor","ngForOf"],["slot","bottom","slot","fixed"],["tab","tasks",3,"click"],["name","hourglass-outline"],["tab","home",3,"click"],["name","home"],["tab","settings",3,"click"],["name","settings"],[1,"projects"],[1,"projects-buttons","bussiness"],[1,"card-content"],[1,"task-count"],[1,"projects-name"],[1,"progress-container"],["mode","ios",3,"value"],["fill","clear",1,"corner-button",3,"click"],["name","chevron-forward-outline"]],template:function(e,n){1&e&&(t.I0R(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title",1),t.OEk(3,"All Your Projects"),t.C$Y()()(),t.I0R(4,"ion-content",2)(5,"ion-header",3)(6,"ion-toolbar")(7,"ion-title",4),t.OEk(8,"Projects"),t.C$Y()()(),t.I0R(9,"div",5),t.yuY(10,y,12,3,"ion-card",6),t.C$Y()(),t.I0R(11,"ion-footer")(12,"ion-toolbar")(13,"ion-tabs")(14,"ion-tab-bar",7)(15,"ion-tab-button",8),t.qCj("click",function(){return n.goToTasks()}),t.wR5(16,"ion-icon",9),t.I0R(17,"ion-label"),t.OEk(18,"Projects"),t.C$Y()(),t.I0R(19,"ion-tab-button",10),t.qCj("click",function(){return n.goToHome()}),t.wR5(20,"ion-icon",11),t.I0R(21,"ion-label"),t.OEk(22,"Home"),t.C$Y()(),t.I0R(23,"ion-tab-button",12),t.qCj("click",function(){return n.goToSettings()}),t.wR5(24,"ion-icon",13),t.I0R(25,"ion-label"),t.OEk(26,"Settings"),t.C$Y()()()()()()),2&e&&(t.E7m("translucent",!0),t.yG2(4),t.E7m("fullscreen",!0),t.yG2(6),t.E7m("ngForOf",n.projects))},dependencies:[d.ay,s.sn,s.KC,s.Gg,s.I7,s._i,s.eV,s.wB,s.Ko,s.QR,s.WU,s.mx,s.ej,s.tM,s.Md,s.CE],styles:['@charset "UTF-8";.title-black[_ngcontent-%COMP%]{color:#000}ion-toolbar[_ngcontent-%COMP%]{--background: var(--ion-background-color, --td-bg)}ion-toolbar[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], ion-toolbar[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-weight:lighter;color:var(--ion-secondary-text-color);font-size:1.66rem}ion-content[_ngcontent-%COMP%]{--background: var(--ion-background-color, --td-bg)}#container[_ngcontent-%COMP%]{padding:3rem 0rem;padding-top:1.5vh}#container[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:xx-large;padding-left:1.2rem;letter-spacing:.5px}.sub-header[_ngcontent-%COMP%], .todays-header[_ngcontent-%COMP%]{text-transform:uppercase;display:block;margin-left:1.2rem;margin-top:4vh;font-size:medium;letter-spacing:.5px;color:var(--ion-secondary-text-color)}.todays-header[_ngcontent-%COMP%]{margin-top:2vh;margin-bottom:3vh}ion-tab-bar[_ngcontent-%COMP%]{--background: #ffffff;--color-selected: #488aff;--color: grey;--mode: ios;padding-top:5px;border-top:1px solid #e0e0e0}.fab-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:100%;padding:10px 0;flex-direction:column;margin-top:20px}.text-below-fab[_ngcontent-%COMP%]{text-align:center;padding:10px 0;text-transform:uppercase;letter-spacing:.5px;color:var(--ion-secondary-text-color)}.projects-name[_ngcontent-%COMP%]{color:#243158;font-size:large;font-weight:600}.projects-buttons[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;padding:1.8rem 1rem 1.1rem;margin:1rem 1rem 1.4rem;margin-right:0;border-radius:1.4rem;font-size:larger;color:var(--ion-color-secondary-contrast);background-color:var(--ion-card-background);text-align:left}.projects-buttons[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .projects-buttons[_ngcontent-%COMP%]   .bx-envelope[_ngcontent-%COMP%]{font-size:xx-large}.projects-buttons[_ngcontent-%COMP%]   ion-progress-bar[_ngcontent-%COMP%]{margin-top:.6rem;--background: var(--ion-progressbar)}.projects-buttons[_ngcontent-%COMP%]   .task-count[_ngcontent-%COMP%]{color:var(--ion-secondary-text-color);font-size:small}.projects-buttons[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-bottom:.7rem}.business[_ngcontent-%COMP%]   ion-progress-bar[_ngcontent-%COMP%]{--progress-background: var(--td-blue)}.progress-container[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%}ion-progress-bar[_ngcontent-%COMP%]{flex-grow:0;width:90%;margin-right:10px}.card-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;padding:16px;width:100%}ion-card[_ngcontent-%COMP%]{width:100%}.card-container[_ngcontent-%COMP%]{width:100%}@media (min-width: 992px){.card-container[_ngcontent-%COMP%]{width:65%;margin-right:40%}}ion-footer[_ngcontent-%COMP%]{position:fixed;bottom:0;width:100%}']}),p})(),canActivate:[g.w]}];let _=(()=>{var i;class p{}return(i=p).\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.a4G({type:i}),i.\u0275inj=t.s3X({imports:[c.qQ.forChild(M),c.qQ]}),p})(),j=(()=>{var i;class p{}return(i=p).\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.a4G({type:i}),i.\u0275inj=t.s3X({imports:[d.MD,h.y,s.wZ,_]}),p})()},5359:(k,f,r)=>{r.d(f,{o:()=>c});var d=r(9212),h=r(4496),s=r(7048);let c=(()=>{var g;class m{constructor(a){this.http=a,this.baseUrl="https://taskflowapp.azurewebsites.net"}register(a){return this.http.post(`${this.baseUrl}/user/register`,a,{withCredentials:!0})}registerByAdmin(a){return this.http.post(`${this.baseUrl}/user/registerByAdmin`,a,{withCredentials:!0})}login(a){return this.http.post(`${this.baseUrl}/user/login`,a,{withCredentials:!0}).pipe((0,d.y)(t=>{localStorage.setItem("username",t.firstName),localStorage.setItem("role",t.role)}))}logout(){return this.http.post(`${this.baseUrl}/user/logout`,{},{withCredentials:!0}).pipe((0,d.y)(()=>{localStorage.removeItem("username"),localStorage.removeItem("role")}))}isLoggedIn(){return!!localStorage.getItem("username")}isUserAdmin(){return"admin"===localStorage.getItem("role")}}return(g=m).\u0275fac=function(a){return new(a||g)(h.CoB(s.KK))},g.\u0275prov=h.wxM({token:g,factory:g.\u0275fac,providedIn:"root"}),m})()},3492:(k,f,r)=>{r.d(f,{U:()=>s});var d=r(4496),h=r(7048);let s=(()=>{var c;class g{constructor(o){this.http=o,this.baseUrl="https://taskflowapp.azurewebsites.net/projects"}getUserProjects(){return this.http.get(`${this.baseUrl}/userProjects`,{withCredentials:!0})}getAssignedProjects(){return this.http.get(`${this.baseUrl}/assignedProjects`,{withCredentials:!0})}getUserProjectMembers(o){return this.http.get(`${this.baseUrl}/${o}/members`,{withCredentials:!0})}getOverdueTasks(o){return this.http.get(`${this.baseUrl}/${o}/overdue-tasks`)}getProjectById(o){return this.http.get(`${this.baseUrl}/get/${o}`,{withCredentials:!0})}deleteProject(o){return this.http.delete(`${this.baseUrl}/delete/${o}`,{withCredentials:!0})}updateProject(o){return this.http.put(`${this.baseUrl}/update/${o.id}`,o,{withCredentials:!0})}getTasksForUserProjectDueToday(o,a){return this.http.get(`${this.baseUrl}/tasks/user/${o}/project/${a}/dueToday`)}deleteUserFromProject(o,a){return this.http.delete(`${this.baseUrl}/${o}/deleteUser/${a}`,{withCredentials:!0})}}return(c=g).\u0275fac=function(o){return new(o||c)(d.CoB(h.KK))},c.\u0275prov=d.wxM({token:c,factory:c.\u0275fac,providedIn:"root"}),g})()},9448:(k,f,r)=>{r.d(f,{K:()=>s});var d=r(7048),h=r(4496);let s=(()=>{var c;class g{constructor(o){this.http=o,this.baseUrl="https://taskflowapp.azurewebsites.net/tasks"}addTask(o){return this.http.post(`${this.baseUrl}/create`,o)}getTasksByUserAndProject(o,a){return this.http.get(`${this.baseUrl}/user/${o}/project/${a}`)}getTodayTasksByProject(o){const t=new d.UD;return t.append("Content-Type","application/json"),this.http.get(`${this.baseUrl}/project/${o}/today`,{headers:t,withCredentials:!0})}getAllTasksByProject(o){const t=new d.UD;return t.append("Content-Type","application/json"),this.http.get(`${this.baseUrl}/project/${o}/all-tasks`,{headers:t,withCredentials:!0})}getAllTasksByProjectAdmin(o){const t={headers:new d.UD({"Content-Type":"application/json"}),withCredentials:!0};return this.http.get(`${this.baseUrl}/project/${o}/all-tasks-admin`,t)}updateTaskStatus(o,a){const t={status:a};return console.log("Sending payload:",JSON.stringify(t)),this.http.put(`${this.baseUrl}/update-status/${o}`,t,{headers:new d.UD({"Content-Type":"application/json"})})}archiveAndDeleteCompletedTasks(){return this.http.post(`${this.baseUrl}/archive-and-delete-completed-tasks`,{})}}return(c=g).\u0275fac=function(o){return new(o||c)(h.CoB(d.KK))},c.\u0275prov=h.wxM({token:c,factory:c.\u0275fac,providedIn:"root"}),g})()}}]);